#!/bin/bash
#SBATCH --job-name=_161_338_80
#SBATCH -D ./
#SBATCH --ntasks=1
#SBATCH --output=benchmarks_simple/definitive_results/analysis/attention_kernel/waiting_cycles/xformers/llama-2-13b/_161_338_80/log_%j.out
#SBATCH --error=benchmarks_simple/definitive_results/analysis/attention_kernel/waiting_cycles/xformers/llama-2-13b/_161_338_80/log_%j.err
#SBATCH --cpus-per-task=20
#SBATCH --gres gpu:1
#SBATCH --time=00:15:00
module load singularity
singularity exec --nv  --env PATH=/home/bsc/bsc098069/.local/bin:/home/bsc/bsc098069/bin:/apps/modules/bsc/bin:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin:/opt/nvidia/nsight-compute/2025.1.0 --env VLLM_ATTENTION_BACKEND=XFORMERS --env PYTHONPATH=/usr/local/lib/python3.12/dist-packages --env PYTHONPATH=/usr/local/lib/python3.12/dist-packages --bind /gpfs/home/bsc/bsc098069/llm_benchmarking/vLLMServingPlateau/vllm/core:/usr/local/lib/python3.12/dist-packages/vllm/core --bind /gpfs/home/bsc/bsc098069/llm_benchmarking/vLLMServingPlateau/vllm/engine:/usr/local/lib/python3.12/dist-packages/vllm/engine --bind /gpfs/home/bsc/bsc098069/llm_benchmarking/vLLMServingPlateau/vllm/entrypoints:/usr/local/lib/python3.12/dist-packages/vllm/entrypoints --bind /gpfs/home/bsc/bsc098069/llm_benchmarking/vLLMServingPlateau/vllm/executor:/usr/local/lib/python3.12/dist-packages/vllm/executor --bind /gpfs/home/bsc/bsc098069/llm_benchmarking/vLLMServingPlateau/vllm/lora:/usr/local/lib/python3.12/dist-packages/vllm/lora --bind /gpfs/home/bsc/bsc098069/llm_benchmarking/vLLMServingPlateau/vllm/model_executor:/usr/local/lib/python3.12/dist-packages/vllm/model_executor --bind /gpfs/home/bsc/bsc098069/llm_benchmarking/vLLMServingPlateau/vllm/worker:/usr/local/lib/python3.12/dist-packages/vllm/worker --bind /gpfs/home/bsc/bsc098069/llm_benchmarking/vLLMServingPlateau/vllm/config.py:/usr/local/lib/python3.12/dist-packages/vllm/config.py --bind /gpfs/home/bsc/bsc098069/llm_benchmarking/vLLMServingPlateau/vllm/sequence.py:/usr/local/lib/python3.12/dist-packages/vllm/sequence.py --bind /gpfs/home/bsc/bsc098069/llm_benchmarking/vLLMServingPlateau/vllm/outputs.py:/usr/local/lib/python3.12/dist-packages/vllm/outputs.py /gpfs/scratch/bsc98/bsc098069/llm_benchmarking/images/vllm-benchmark-default-nsight-compute.sif ncu -o benchmarks_simple/definitive_results/analysis/attention_kernel/waiting_cycles/xformers/llama-2-13b/_161_338_80/ncu_profile --nvtx --nvtx-include "DecodeStep335" -k regex:paged_attention_v1_kernel -c 5 --set full --verbose python3 benchmarks_simple/decoding_offline_profiler.py --result-dir='benchmarks_simple/definitive_results/analysis/attention_kernel/waiting_cycles/xformers/llama-2-13b/_161_338_80' --model=/gpfs/scratch/bsc98/bsc098069/llm_benchmarking/models/llama/llama-2-13b --without-profiler --max-num-batched-tokens=4096 --max-num-seqs=1024 --max-model-len=2048 --disable-log-stats --enforce-eager --include-nvtx-regions --prompt-len='161' --output-len='338' --batch-size='80'
